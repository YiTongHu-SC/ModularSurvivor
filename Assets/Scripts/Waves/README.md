﻿# Waves - 敌人波次系统

## 概述
管理敌人生成和波次推进的完整系统，实现类似幸存者游戏的持续战斗体验。支持可配置的波次设计、动态难度调整和多种敌人生成策略。

## 系统架构

### Systems/ - 波次管理核心
- **WaveSystem**：波次系统主控制器
  - 管理当前活跃波次列表
  - 协调波次的创建、更新和销毁
  - 提供波次状态查询接口
  
- **WaveManager**：波次流程管理器
  - 控制波次的开始和结束逻辑
  - 处理波次间的过渡和衔接
  - 管理游戏整体节奏

- **Wave**：单个波次实例
  - 封装单个波次的完整生命周期
  - 管理该波次的敌人生成和状态
  - 处理波次完成条件判断

- **WaveConfigsHandler**：配置处理器
  - 加载和解析波次配置数据
  - 提供配置数据的统一访问接口
  - 支持运行时配置热更新

### Spawners/ - 敌人生成器系统
- **BaseSpawner**：生成器基类
  - 定义生成器的基础接口和生命周期
  - 提供通用的生成逻辑框架
  
- **SimpleSpawner**：简单生成器实现
  - 基础的定时生成功能
  - 支持指定位置和数量的敌人生成
  - 适用于固定模式的敌人刷新

### Data/ - 波次配置数据
- **WaveConfig**：波次配置数据结构
  - 定义波次的基本参数（持续时间、敌人类型、数量等）
  - 支持复杂的生成规则配置
  - 包含难度和奖励等元数据

## 核心特性

### 波次管理机制
- **时间驱动**：基于时间轴的波次推进系统
- **条件触发**：支持多种波次触发条件（时间、敌人清空等）
- **重叠支持**：允许多个波次同时进行
- **状态追踪**：实时监控波次进度和状态

### 敌人生成策略
- **位置算法**：智能的敌人生成位置计算
- **数量控制**：动态调节场上敌人数量
- **类型混合**：支持单波次多种敌人类型
- **间隔控制**：可配置的生成时间间隔

### 难度调节系统
- **时间递增**：随游戏时间增加敌人强度和数量
- **动态平衡**：根据玩家表现调整难度曲线
- **配置驱动**：通过外部配置控制难度参数

### 配置系统
- **数据驱动**：所有波次参数都通过配置文件定义
- **热更支持**：支持运行时重新加载配置
- **易于调试**：提供完善的配置验证和错误提示

## 设计特色

### 模块化架构
- 各组件职责明确，便于独立开发和测试
- 通过接口和事件进行松耦合通信
- 支持运行时动态替换不同的生成策略

### 性能优化
- **对象池技术**：重用敌人对象减少GC压力
- **批量处理**：批量生成和更新提升效率
- **智能调度**：根据性能情况动态调节生成频率

### 扩展性设计
- **插件化生成器**：易于添加新的生成模式
- **事件驱动**：支持外部系统监听波次事件
- **配置扩展**：配置结构支持向后兼容的扩展

## 使用流程

```csharp
// 获取波次系统
var waveSystem = WaveSystem.Instance;

// 添加新波次
waveSystem.AddWave(waveConfig);

// 更新波次系统
waveSystem.UpdateWaves(deltaTime);

// 查询波次状态
var activeWaves = waveSystem.GetActiveWaves();
```

## 配置示例

```csharp
// 波次配置数据
var waveConfig = new WaveConfig
{
    Duration = 60f,
    EnemyType = EnemyType.BasicZombie,
    SpawnCount = 10,
    SpawnInterval = 2f,
    DifficultyMultiplier = 1.2f
};
```

## 扩展指导

### 添加新的生成器类型
1. 继承`BaseSpawner`创建新的生成器类
2. 实现特定的生成逻辑和规则
3. 在配置系统中注册新的生成器类型

### 自定义波次规则
1. 扩展`WaveConfig`数据结构
2. 在`Wave`类中实现新的逻辑处理
3. 更新配置处理器支持新的规则解析

### 集成其他系统
- 通过事件系统监听波次开始/结束事件
- 与UI系统集成显示波次信息
- 与音效系统配合播放波次提示音
- 波次间隔和难度递增
- 灵活的配置系统
