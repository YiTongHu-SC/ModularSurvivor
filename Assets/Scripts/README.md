﻿# Scripts - 代码架构总览

## 概述
模块化幸存者游戏的核心代码实现，采用"2D逻辑，3D表现"的分层架构。所有游戏逻辑在2D坐标系运行，Unity的3D系统仅用于视觉表现。

## 架构原则

### 核心设计理念
- **逻辑表现分离**：业务逻辑使用纯C#类，不依赖Unity MonoBehaviour
- **模块化低耦合**：各系统独立开发，通过事件系统和接口通信
- **配置驱动开发**：游戏数值和行为通过ScriptableObject外部配置
- **可测试性优先**：核心逻辑支持单元测试

### 技术特色
- **2D坐标系统**：所有位置计算在2D平面，简化逻辑复杂度
- **事件驱动架构**：模块间使用事件进行松耦合通信
- **单例服务模式**：核心管理器使用单例模式提供全局访问
- **组合模式设计**：优先使用组合而非继承

## 模块详细说明

### Core/ - 核心基础设施
**职责**：提供项目基础功能和通用工具
**包含**：
- **Input/**：统一输入管理，支持多平台输入设备
- **Coordinates/**：2D逻辑与3D表现的坐标转换
- **Units/**：单位数据结构和基础管理功能
- **Events/**：全局事件系统和事件定义
- **Timer/**：游戏计时器和时间管理
- **Abstructs/**：基础抽象类和接口定义

### Combat/ - 战斗核心系统
**职责**：实现完整的自动战斗机制
**包含**：
- **Systems/**：战斗管理器、伤害系统、技能系统、Buff系统
- **Ability/**：技能实现（激光攻击、追踪弹等）
- **Movement/**：移动系统和多种移动策略
- **Buff/**：增益减益效果系统（6种Buff类型）
- **Actors/**：战斗单位的数据和行为封装
- **Views/**：战斗表现层组件

### Waves/ - 敌人波次系统
**职责**：管理敌人生成和波次推进
**包含**：
- **Systems/**：波次管理和配置处理
- **Spawners/**：敌人生成器和生成策略
- **Data/**：波次配置数据结构

### GameLoop/ - 游戏循环管理
**职责**：整合各系统，管理游戏生命周期
**包含**：
- **Game/**：游戏主管理器和状态控制
- **Config/**：游戏全局配置管理
- **GameDebug/**：开发调试工具
- **Utils/**：游戏循环相关工具类

### UI/ - 用户界面系统
**职责**：处理游戏UI显示和交互
**包含**：
- **Game/**：游戏内UI（血条、状态显示等）
- **Menus/**：菜单界面和导航

### Utils/ - 通用工具库
**职责**：提供数学运算、扩展方法等工具
**包含**：
- **Core/**：2D数学运算、向量工具
- 其他通用扩展和帮助类

## 已实现核心功能

### 输入系统
- 基于Unity InputSystem的多平台输入支持
- 事件驱动 + 状态查询的混合模式
- 支持键盘、手柄、移动端适配

### 战斗系统
- 自动攻击机制（类似幸存者游戏）
- 多种技能类型：激光攻击、碰撞检测、追踪攻击
- 完整的Buff系统：速度、攻击力、DOT/HOT效果
- 智能移动AI：直线追击、简单移动等策略

### 单位管理
- 2D坐标系下的单位位置和方向管理
- 碰撞检测和交互处理
- 分阵营的单位分组管理

### 波次系统
- 可配置的敌人生成波次
- 多种生成策略和时机控制

## 开发规范

### 代码组织
1. 业务逻辑优先放入对应的System服务类
2. MonoBehaviour主要用于View层和Unity生命周期
3. 使用事件系统进行跨模块通信
4. 保持接口简洁，职责单一

### 扩展指导
1. 新系统参考现有模块的结构模式
2. 优先使用组合模式而非深度继承
3. 保持核心逻辑的可测试性
4. 遵循现有的命名约定和文档标准
